(function(){window.promoter=window.promoter||new function(){var c=this;var b={};var a={encode:function(){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return function(l){var p,o,q,j,n,r,i;o=q=0;j=l.length;n=j%3;j=j-n;r=(j/3)<<2;if(n>0){r+=4}p=new Array(r);while(o<j){i=l.charCodeAt(o++)<<16|l.charCodeAt(o++)<<8|l.charCodeAt(o++);p[q++]=f[i>>18]+f[i>>12&63]+f[i>>6&63]+f[i&63]}if(n==1){i=l.charCodeAt(o++);p[q++]=f[i>>2]+f[(i&3)<<4]+"=="}else{if(n==2){i=l.charCodeAt(o++)<<8|l.charCodeAt(o++);p[q++]=f[i>>10]+f[i>>4&63]+f[(i&15)<<2]+"="}}return p.join("")}}(),decode:function(){var f=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];return function(i){var p,r,t,u;var l,q,j,w,v,s;j=i.length;if(j%4!==0){return""}if(/[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\+\/\=]/.test(i)){return""}if(i.charAt(j-2)=="="){w=1}else{if(i.charAt(j-1)=="="){w=2}else{w=0}}v=j;if(w>0){v-=4}v=(v>>2)*3+w;s=new Array(v);l=q=0;while(l<j){p=f[i.charCodeAt(l++)];if(p==-1){break}r=f[i.charCodeAt(l++)];if(r==-1){break}s[q++]=String.fromCharCode((p<<2)|((r&48)>>4));t=f[i.charCodeAt(l++)];if(t==-1){break}s[q++]=String.fromCharCode(((r&15)<<4)|((t&60)>>2));u=f[i.charCodeAt(l++)];if(u==-1){break}s[q++]=String.fromCharCode(((t&3)<<6)|u)}return s.join("")}}()};var d=new function(){function f(h){return encodeURIComponent(h).replace(/\'/g,"%27")}function g(h){return decodeURIComponent(h.replace(/%27/g,"'"))}this.EXPIRES={YEAR:365*24*3600,MONTH:30*24*3600,DAY:24*3600,HOUR:3600};this.set=function(h,i,j){j=$.extend(true,{path:"/",expires:this.EXPIRES.YEAR,domain:null},j);document.cookie=h+"="+f(i)+";path="+j.path+(j.domain?";domain="+j.domain:"")+((j.expires)?";expires="+new Date(new Date().getTime()+j.expires*1000).toGMTString():"");return this};this.get=function(j,i){if(document.cookie.length>0){var h,k=document.cookie.indexOf(j+"=");if(k!=-1){k=k+j.length+1;h=document.cookie.indexOf(";",k);if(h==-1){h=document.cookie.length}return g(document.cookie.substring(k,h))}}return i};this.exists=function(h){return document.cookie.length>0&&document.cookie.indexOf(h+"=")!=-1};this.remove=function(h,i){this.set(h,"",$.extend(true,{},i||{},{expires:-1}));return this}};function e(i,j){var f=this;var k=null;function m(){k=setTimeout(l,j*1000)}function g(){clearTimeout(k)}function h(){g();m()}function l(){i(h)}this.reset=function(){h();return this};this.stop=function(){g();return this};this.start=function(){m();return this};this.init=function(n){k=setTimeout(l,(n||0)*1000);return this}}this.lock=function(f){b[f]=true;return this};this.unlock=function(f){b[f]=false;return this};this.locked=function(){for(var f in b){if(b[f]==true){return true}}return false};this.Slides={items:{},filter:function(j){function g(i){i.content=i.content.replace(/{(@[A-Z0-9_]+)}/g,function(n,m){var l=n;switch(m){case"@RND":l=Math.floor((Math.random()*999999)+1);break;case"@TIMESTAMP":l=(new Date).getTime();break}return l});return i}var f=[];for(var h=0,k;h<j.length;h++){k=j[h];if(k in this.items){f.push(g($.extend(true,{id:k},this.items[k])))}}return f},exclude:function(h){var j=Object.keys(this.items);var f=[];for(var g=0,k;g<j.length;g++){k=j[g];if(h.indexOf(k)==-1){f.push(k)}}return this.filter(f)},all:function(){return this.filter(Object.keys(this.items))}};this.Engine=function(D,H){var t=0,o=15,x=15*60,B=45;var G="				<div id='PROMOTER' class='promoter v2' unselectable='on'>					<div class='promoter-body'>						<div class='container'>							<div class='row'>								<div class='col-md-3 hidden-xs hidden-sm'>									<div class='promoter-image'>										<span></span>									</div>								</div>								<div class='col-md-9'>									<div class='promoter-content'>										<div></div>									</div>								</div>							</div>							<a href='#promoter-prev' class='promoter-prev'></a>							<a href='#promoter-next' class='promoter-next'></a>						</div>						<a href='#promoter-close' class='promoter-close' title='Закрыть'></a>					</div>					<div class='promoter-shadow'></div>				</div>			";H=$.extend(true,{domain:null},H);var k=this;var h=$(G).prependTo($("body")),n=h.find(".promoter-body"),y=h.find(".promoter-close"),r=h.find(".promoter-prev"),u=h.find(".promoter-next"),g=$(null).add(r).add(u),z=h.find(".promoter-image"),s=n.find(".promoter-content");var m=null,j=null,q=null;function w(J){if(!J){J=d.get("promoter","");try{J=JSON.parse(a.decode(J))}catch(K){J={}}if(!(typeof J=="object"&&"ver" in J)){d.remove("promoter")}return $.extend(true,{ver:0.2,timestamp:3600*24*1000,showing:{}},J)}else{d.set("promoter",a.encode(JSON.stringify(J)),{domain:H.domain})}}function E(){return h.is(":visible")}function l(){return h.is(":hidden")}function p(){return $(window).scrollTop()<=2*h.height()/3}function I(J){$(k).trigger("show");h.css({"margin-top":(-1*h.height())+"px"}).show().animate({"margin-top":0},250,function(){if(J){J.call(k)}$(k).trigger("shown")})}function v(J){$(k).trigger("hide");h.animate({"margin-top":(-1*h.height())+"px"},250,function(){h.hide();if(J){J.call(k)}$(k).trigger("hidden")})}function f(K,M){var P,Q,R;if(typeof K=="number"||K instanceof Number){P=D[K];R=K;Q=P.id}else{for(var N=0,O;N<D.length;N++){O=D[N];if(O.id===K){P=O;R=N;Q=P.id;break}}}$(k).trigger("slide");var L=z.find("> *"),J=s.find("> *");J.fadeOut(250,function(){L.animate({bottom:"-"+L.height()+"px"},250,function(){L.hide().remove();L=$("<span/>").hide().appendTo(z);L.css({bottom:"-"+L.height()+"px","background-image":"url('"+P.image+"')"}).show();L.animate({bottom:0},250,function(){J.hide().remove();J=$(P.content).hide().appendTo(s);J.fadeIn(250);if(M){M.call(k)}})})});j=Q;m=R}function C(J){var K=(m<D.length-1)?m+1:0;f(K,J)}function A(J){var K=(m>0)?m-1:D.length-1;f(K,J)}function i(P){if(!c.locked()){var T=w(),O=(new Date()).getTime();var J=(D.length>=1)&&l()&&p()&&(O-T.timestamp>=x*1000),L=(D.length>1)&&E()&&(O-T.timestamp>=B*1000);if(J||L){var X=[];for(var M=0,N,W,U,R;M<D.length;M++){N=D[M];W=N.id;U=T.showing[W]||0;if(j!=N.id){if(X.length==0){X.push([W,U])}else{R=true;for(var K=0;R&&K<X.length;K++){if(X[K][1]>=U){X.splice(K,0,[W,U]);R=false}}if(R){X.push([W,U])}}}}var V=X[Math.floor(Math.random()*Math.ceil(X.length/2))],Q=V[0],S=V[1];f(Q,J?function(){I(P)}:P);T.timestamp=O;T.showing[Q]=S+1;w(T)}else{P()}}else{P()}}this.run=function(){q.init(t);return this};function F(){g.bind("click",function(L){L.preventDefault();var J=$(L.currentTarget);if(!J.is("[data-lock]")){g.attr("data-lock","on");var K=J.is(u)?C:A;q.stop();K(function(){g.removeAttr("data-lock");q.start()})}});y.bind("click",function(J){J.preventDefault();v()});if(D.length>1){r.show();u.show()}q=new e($.proxy(i,k),o)}F.call(this)}}})();