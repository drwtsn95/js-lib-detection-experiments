var FancySelect=new Class({Implements:[Options,Events],options:{legacyEvents:false,showText:true,showImages:true,className:'fancy-select',offset:{x:0,y:0},autoHide:false,autoScrollWindow:false,animateFade:true,animateSlide:true,fx:{'duration':'short'},relativeTo:document.body},initialize:function(element,options){this.setOptions(options);this.options.animateSlide=false;this.element=document.id(element);this.element.store('fancyselect_object',this);this._create();this.attach();if(element.onchange){element.addEvent('change',function(){this.exec(element.getProperty('onchange'),window);}.bind(this));}
if(this.options.autoScrollWindow)this.addEvent('show',function(){var windowScroll=window.getScroll();var overflow=this.ul.getPosition().y+this.ul.getSize().y-window.getSize().y-windowScroll.y;if(overflow>0)window.scrollTo(windowScroll.x,windowScroll.y+overflow+10);});if(this.options.autoHide)document.addEvent('click',function(e){if(!this.shown)return;var target=document.id(e.target);var parents=target.getParents().include(target);if(!parents.contains(this.ul)&&!parents.contains(this.div))this.hide();}.bind(this));return this;},attach:function(){this.element.setStyle('display','none');this.select(this.element.get('value'));if(Browser.ie)window.addEvent('load',function(){this.select(this.element.get('value'));}.bind(this));this.ul.inject(this.element,'after');this.ul.setStyle('display','none');this.div.inject(this.element,'after');this.attached=true;this.fireEvent('attach');return this;},detach:function(){if(this.ul)this.ul.dispose();if(this.div)this.div.dispose();this.element.setStyle('display','');this.attached=false;this.fireEvent('detach');return this;},select:function(value){if(this.element.get('value')!=value){this.element.set('value',value);if(this.options.legacyEvents){this.element.fireEvent('change');this.element.getParents().fireEvent('change');}}
var vvalue='v'+value;if(this.options.showText)this.div.getElement('span.text').set('text',this.selectOptions[vvalue].text);if(this.options.showImages)this.div.getElement('img.image').setProperties({'src':this.selectOptions[vvalue].image,'alt':this.selectOptions[vvalue].alt});if(this.ul){this.ul.getElements('li').each(function(li){if(li.getProperty('data-value')==value)li.addClass('selected');else li.removeClass('selected');});}
return this;},update:function(){var attached=this.attached;this.detach();this._create();if(attached)this.attach();return this;},show:function(){var offset=this.options.offset;var position=this.div.getCoordinates(this.options.relativeTo);this.ul.setStyles({'top':position.top+position.height+offset.y,'left':position.left+offset.x});this._animate(false);this.shown=true;this.ul.setStyle('display','block');return this;},hide:function(){this._animate(true);this.shown=false;this.ul.setStyle('display','none');return this;},toggle:function(){if(this.shown)return this.hide();else return this.show();},exec:function(functionName,context){var self=this;var tokens=functionName.replace(/\);?/g,'').split('(');var namespace=tokens[0].split('.');var args=tokens[1].split(',');args=args.map(function(item){if(item.substr(0,5)=='this.'){var key=item.substr(5,item.length);return self.element.getProperty(key);}
return item.replace(/['"]*/g,'');});if(namespace.length>1)
for(var i=0;i<namespace.length-1;i++)
context=context[namespace[i]];var func=namespace.pop();context[func].apply(context,args);},_create:function(){var o=this.options;if(this.ul)this.ul.destroy();if(this.div)this.div.destroy();this.selectOptions={};this.element.getElements('option').each(function(option){var value=option.getProperty('value');var vvalue='v'+value;this.selectOptions[vvalue]={};if(option.get('disabled'))this.selectOptions[vvalue].disabled=true;if(o.showText)this.selectOptions[vvalue].text=option.get('text');if(o.showImages){this.selectOptions[vvalue].image=option.getProperty('data-image');this.selectOptions[vvalue].alt=option.getProperty('data-alt');}}.bind(this));this.ul=new Element('ul').addClass(o.className);Object.each(this.selectOptions,function(option,value){var li=new Element('li',{'data-value':value.substr(1)});if(option.disabled)li.addClass('disabled');if(o.showImages&&option.image)li.adopt(new Element('img.image',{'src':option.image,'alt':option.alt}));if(o.showText&&option.text)li.adopt(new Element('span.text',{'text':option.text}));li.addEvent('click',function(){if(li.hasClass('disabled'))return;this.select(li.getProperty('data-value'));this.hide();}.bind(this));this.ul.adopt(li);}.bind(this));this.ul.setStyles({position:'absolute',top:0,left:0});if(o.animateFade)this.ul.set('tween',o.fx);if(o.animateSlide)this.ul.set('slide',o.fx);this.div=new Element('div').addClass(o.className);if(o.showImages)this.div.adopt(new Element('img.image'));if(o.showText)this.div.adopt(new Element('span.text'));this.div.adopt(new Element('span.arrow'));this.div.addEvent('click',function(){this.toggle();}.bind(this));return this;},_animate:function(out){var o=this.options;if(o.animateFade)this.ul.fade(out?'out':'in');if(o.animateSlide)this.ul.slide(out?'out':'in');if(!o.animateFade&&!o.animateSlide)this.ul.fade(out?'hide':'show');return this;}});Elements.implement({fancySelect:function(options){this.each(function(el){new FancySelect(el,options);});return this;}});Element.implement({fancySelect:function(options){new FancySelect(document.id(this),options);return this;},fancySelectShow:function(){var fs=this.retrieve('fancyselect_object');if(fs)fs.show(this);return this;},fancySelectHide:function(){var fs=this.retrieve('fancyselect_object');if(fs)fs.hide(this);return this;},fancySelectToggle:function(){var fs=this.retrieve('fancyselect_object');if(fs)fs.toggle(this);return this;}});Element.Properties.fancySelect={get:function(){return this.retrieve('fancyselect_object');}};(function(){if(typeof window.CustomEvent==="function")return false;function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent('CustomEvent');evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt;}
CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent;})();if(!String.prototype.includes){String.prototype.includes=function(search,start){'use strict';if(search instanceof RegExp){throw TypeError('first argument must not be a RegExp');}
if(start===undefined){start=0;}
return this.indexOf(search,start)!==-1;};}
if(!Array.prototype.findIndex){Object.defineProperty(Array.prototype,'findIndex',{value:function(predicate){if(this==null){throw new TypeError('"this" is null or not defined');}
var o=Object(this);var len=o.length>>>0;if(typeof predicate!=='function'){throw new TypeError('predicate must be a function');}
var thisArg=arguments[1];var k=0;while(k<len){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o)){return k;}
k++;}
return-1;},configurable:true,writable:true});}
var Application=new Class({Implements:[Options,Events],hasStorage:false,touchEnabled:false,currentMenuIndex:null,xhr:null,url:new URI(window.location),winScroll:null,menuFX:null,mobileNavFX:null,channelAdvisorTkn:'Z58QH8nvuxDQlHRDCC7M4dF0V7GB4E/NQuWW3htzO7q+cYwMJzh27vk1t0LOjipsfIozPdV8DHGTZLdSXbY59613a0M5xFw+JEOee9K1zVs=',ecommLinkDev:'https://staging-na-conair.demandware.net/on/demandware.store/',ecommLinkProd:'https://shop.conair.com/on/demandware.store/',ecommDevMode:false,ajaxSpinner:null,timeoutID:null,currentScroll:0,currentWidth:0,carousels:[],carouselSpeed:5000,cart:{},options:{DOM:{},isPost:false,addScrollDepth:false,debug:false,allowedFiles:[],previewPinNotification:false,previewPinAutoClose:true,toggleMsgBanner:false},initialize:function(options){var catStr,catArray;this.setOptions(options);this.initNav();this.initMobileNav();this.initCarousels();this.initParallax();var scrollOffsetY=parseInt(this.options.DOM.header.getCoordinates().height);if(document.body.hasClass('notify-active')){scrollOffsetY=scrollOffsetY+parseInt($('terms-update').getCoordinates().height);}
this.winScroll=new Fx.Scroll(window,{link:'cancel',wheelStops:true,duration:1500,transition:Fx.Transitions.Quint.easeOut,offset:{x:0,y:-scrollOffsetY},onStart:function(){},onCancel:function(){}});if(this.options.toggleMsgBanner){document.body.addClass('notify');}else{if(document.body.hasClass('notify'))
document.body.removeClass('notify');}
this.ajaxSpinner=new Element('span',{'class':'async-spinner'});this.ajaxSpinner.adopt(new Element('span',{'class':'bounce-1'}));this.ajaxSpinner.adopt(new Element('span',{'class':'bounce-2'}));this.ajaxSpinner.adopt(new Element('span',{'class':'bounce-3'}));if(this.options.debug){var debug=new Element('span',{'id':'debug','styles':{'display':'inline-block','position':'fixed','top':0,'left':0,'z-index':1000000,'background-color':'#000','color':'#fff','font-family':'Consolas, "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", Monaco, "Courier New", monospace','font-size':'0.75rem'},'html':'RWD Debug Information'});debug.inject(document.body,'top');}
if(this.options.previewPinNotification){var pinContainer=$$('.pin-container')[0];if(pinContainer){pinContainer.addClass('active');if(this.options.previewPinAutoClose){setTimeout(function(){pinContainer.removeClass('active');},8000);}}}
if('ontouchstart'in window){var htmlNode=document.querySelector("html");if(htmlNode)htmlNode.addClass('has-touch');this.touchEnabled=true;}
if(typeof(Storage)!=="undefined"){var htmlNode=document.querySelector("html");if(htmlNode)htmlNode.addClass('has-storage');this.hasStorage=true;}
this.currentWidth=window.getCoordinates().width;if(this.options.addScrollDepth){var increment=100;var maxHeight=parseInt(this.options.DOM.viewport.getCoordinates().height);var dive=new Element('aside',{'class':'dive-dive'}).inject(document.body,'top');for(i=0;i<=maxHeight;i+=increment){var depth=new Element('span',{'class':'depth','html':'Depth: '+i+'px','styles':{'top':i}}).inject(dive,'bottom');}}
var scrollStatus=$('scroll-status');var mobileImages=$$('[data-mobile-image]');window.addEvents({'domready':function(event){if(mobileImages.length)
this.parseMobileImages(mobileImages);}.bind(this),'load':function(){var fragment=window.location.hash;if(fragment){fragment=fragment.substring(1);var el=$(fragment);var posY=parseInt(el.getCoordinates(document.body).top);window.scrollTo({top:(posY+this.winScroll.options.offset.y),left:0,behavior:'smooth'});}}.bind(this),'keyup':function(event){if(event.key=='esc')
this.options.DOM.subNav.removeClass('active');}.bind(this),'resize':function(event){this.currentWidth=window.getCoordinates().width;if(this.options.debug)
debug.setProperty('html','Width: '+this.currentWidth+'px');if(this.currentWidth>980&&$('nav-toggle')){$('nav-toggle').checked=false;this.toggleMobileMenu(false);}
if(mobileImages.length)
this.parseMobileImages(mobileImages);}.bind(this),'scroll':function(){this.currentScroll=window.getScroll().y;if(this.options.debug)
debug.setProperty('html',this.currentScroll);if(scrollStatus){var value=(this.currentScroll /(this.options.DOM.viewport.getCoordinates().height-window.innerHeight))*100;scrollStatus.setProperty('value',value);}
clearTimeout(this.scrollTimer);this.scrollTimer=setTimeout(function(){if(this.currentScroll>0){var scrollDepth=Math.ceil(this.currentScroll/250)*250;var title=(document.title!=='')?document.title:window.location;ga('send','event','Scroll Depth (rounded to nearest hundred)',title,scrollDepth);}}.bind(this),4000);}.bind(this)});$$('a[data-modal]').each(function(link,index){link.addEvent('click',function(event){event.preventDefault();var target=$(link.dataset.modal);if(target){$('jump-link').href=link.href;this.toggleModal(link,event,1);}}.bind(this));},this);this.konami();},injectIframe:function(el,event){if(event)event.preventDefault();var target=$(el.dataset.modal).getElement('.modal-content');console.log(el.dataset.bvLink);var iframe=new IFrame({src:el.dataset.bvLink,events:{load:function(){this.contentDocument.querySelector('.bv-mbox-close').setStyle('dislay','none!important');}}});target.empty();target.adopt(iframe);},parseMobileImages:function(mobileImages){var currentWidth=this.currentWidth;if(mobileImages.length){mobileImages.each(function(el,i){var imgNode=el.getElement('img');var currentSrc=imgNode.getProperty('src');var mobileSrc=el.dataset.mobileImage;var breakPoint=(el.dataset.mobileBreakpoint)?parseInt(el.dataset.mobileBreakpoint):768;if(!el.dataset.desktopImage)
el.dataset.desktopImage=imgNode.getProperty('src');if(currentWidth<breakPoint){if(currentSrc!=mobileSrc)
imgNode.setProperty('src',mobileSrc);}else{if(currentSrc!=el.dataset.desktopImage)
imgNode.setProperty('src',el.dataset.desktopImage);}});}
return;},toggleModal:function(parent,event,state){if(event){event.preventDefault();event.stopPropagation();}
var target=$(parent.dataset.modal);var modalContent=target.getElement('.modal-content');var modalMask=$('modal-mask');if(target){var close=target.getElement('a.modal-close');close.addEvent('click',function(){if(typeof close.dataset.removeContents!='undefined'&&parseInt(close.dataset.removeContents)==1&&modalContent)
modalContent.empty();this.toggleModal(parent,event,0);}.bind(this));jumpClose=target.getElements('a.jump-modal-close');jumpClose.addEvent('click',function(){this.toggleModal(parent,event,0);}.bind(this));if(state==1){target.addClass('modal-show');modalMask.addEvent('click',function(){if(typeof close.dataset.removeContents!='undefined'&&parseInt(close.dataset.removeContents)==1&&modalContent)
modalContent.empty();this.toggleModal(parent,event,0);}.bind(this));return;}else{target.removeClass('modal-show');return;}}else{return;}},konami:function(){var input='',pattern='3838404037393739666513';window.document.onkeydown=function(e){input+=e?e.keyCode:event.keyCode;if(input.indexOf(pattern)!=-1){var qs=window.location.search;var url=qs?qs+'&k=1':'?k=1';window.location=location.href+url;return;}}},initNav:function(){var self=this,timeout;var toolBar=$('toolbar');if(toolBar){toolBar.addEvents({'mouseenter':function(){if(self.options.DOM.primaryNav){var navItems=self.options.DOM.primaryNav.getElements('ul li');if(navItems.length)
navItems.removeClass('selected');clearTimeout(self.timeoutID);self.hideMenu.bind(self);}}});}
try{var navItems=self.options.DOM.primaryNav.getElements('ul li');navItems.each(function(item,index){var link=item.getElement('a');if(!link)
return;var lvl1Links=$(link.rel).getElements('.category-level2 ul li');var lvl2Links=$(link.rel).getElements('.category-level3 ul li');link.addEvents({'keyup':function(event){if(event.key=='space'){lvl1Links[0].focus();}},'mouseenter':function(){clearTimeout(self.timeoutID);navItems.removeClass('selected');item.addClass('selected');this.setProperties({'aria-selected':true,'aria-expanded':true});if(self.options.DOM.subNav.hasClass('active')){var target=item.getElement('a').getProperty('rel');self.showMenu(target);}else{self.timeoutID=setTimeout(function(){self.options.DOM.subNav.addClass('active');self.showMenu(item.getElement('a').getProperty('rel'));},500,self);}},'focus':function(){clearTimeout(self.timeoutID);navItems.removeClass('selected');item.addClass('selected');this.setProperties({'aria-selected':true,'aria-expanded':true});if(self.options.DOM.subNav.hasClass('active')){var target=item.getElement('a').getProperty('rel');self.showMenu(target);}else{self.timeoutID=setTimeout(function(){self.options.DOM.subNav.addClass('active');self.showMenu(item.getElement('a').getProperty('rel'));},500,self);}},'mouseleave':function(){clearTimeout(self.timeoutID);this.setProperties({'aria-selected':false,'aria-expanded':false});},'mouseover':function(){clearTimeout(self.timeoutID);},'blur':function(){clearTimeout(self.timeoutID);this.setProperties({'aria-selected':false,'aria-expanded':false});}});});self.options.DOM.primaryNav.addEvent('mouseleave',self.hideMenu.bind(self));self.options.DOM.subNav.addEvents({'mouseleave':function(){clearTimeout(self.timeoutID);self.timeoutID=setTimeout(function(){self.hideMenu();},250,self);},'mouseenter':function(){clearTimeout(self.timeoutID);self.options.DOM.subNav.addClass('active');}});}
catch(err){console.log('Main Nav\' Element Not Present');}},showSubNav:function(parent,event,state){var tolerance=50;if(event){event.preventDefault();event.stopPropagation();}
parent.getParent('ul').getElements('li').removeClass('active');parent.getParent('li').addClass('active');this.subNavFX=null;if(this.subNavFX!=null&&this.subNavFX.isRunning())
this.subNavFX.cancel();var subCats=$('sub-nav').getElements('div.sub-category');subCats.setStyles({'display':'none','opacity':0});var targetSubCat=$(parent.rel);if(!parent.getParent('li').hasClass('no-sub')){this.subNavFX=new Fx.Tween(targetSubCat,{link:'cancel',property:'opacity',duration:750,onStart:function(){targetSubCat.setStyles({'display':'block','opacity':0});targetSubCat.getParent('div.colgroup').setStyles({'top':50});var container=$('sub-nav');var parentBottom=parent.getCoordinates(container).bottom.toInt();var targetBottom=targetSubCat.getCoordinates(container).bottom.toInt();if((parentBottom-targetBottom)>tolerance){var top=(parentBottom-targetSubCat.getCoordinates().height.toInt());top=top-window.getScroll().y;if(top>0){targetSubCat.getParent('div.colgroup').setStyles({'top':top});}}},onCancel:function(){targetSubCat.setStyles({'display':'block','opacity':0});}}).start(1);}},hideMenu:function(){clearTimeout(this.timeoutID);this.timeoutID=setTimeout(function(){var navItems=this.options.DOM.primaryNav.getElements('ul li');this.options.DOM.subNav.removeClass('active');navItems.removeClass('selected');}.bind(this),50);},showMenu:function(category){if(this.menuFX!=null)this.menuFX.cancel();$$('div.category').setStyles({'display':'none','opacity':0});if($(category)){$(category).setStyles({'display':'block','opacity':0});this.menuFX=new Fx.Tween($(category),{property:'opacity',duration:500,transition:Fx.Transitions.Expo.easeInOut,link:'cancel'}).start(1);}},toggleMobileMenu:function(checked){var resetSlider=function(){this.mobileNavFX.set(0,0);}.bind(this);if(checked){this.options.DOM.hamburger.addClass('active');this.options.DOM.mobileNav.addClass('active');document.body.addClass('menu-active');}else{this.options.DOM.hamburger.removeClass('active');this.options.DOM.mobileNav.removeClass('active');document.body.removeClass('menu-active');setTimeout(resetSlider,500);}},toggleSocial:function(parent,event){if(event){event.preventDefault();event.stopPropagation();}
var toggleEl=$('sharing');if(typeof parent.dataset!='undefined'){if(parent.dataset.toggled==-1){toggleEl.addClass('toggled');parent.dataset.toggled=1;}else{toggleEl.removeClass('toggled');parent.dataset.toggled=-1;}}},initMobileNav:function(){var self=this;var slideEl=$('mobile-nav').getElement('div.colgroup');var logo=$('logo');self.mobileNavFX=new Fx.Scroll(slideEl,{onComplete:function(){}});var mobileSearch=$('mobile-search');if(mobileSearch){mobileSearch.addEvents({'click':function(){mobileSearch.addClass('expanded');logo.fade('out');}});mobileSearch.getElement('input[type=search]').addEvents({'blur':function(){mobileSearch.removeClass('expanded');logo.fade('in');},'keyup':function(e){if(this.value.length>0)
mobileSearch.getElement('input[type="submit"]').style.setProperty("display","block","important");else
mobileSearch.getElement('input[type="submit"]').style.removeProperty("display");}});}},getMobileNav:function(caller,event){event.preventDefault();var self=this,updateEl=$('sub-categories');var catID=caller.rel.split('-');if(catID.length>0)
catID=catID[catID.length-1];self.mobileNavFX.removeEvents('complete');if(catID==0){self.mobileNavFX.addEvents({'complete':function(){updateEl.setStyles({'display':'none'});}});self.mobileNavFX.toElement('root-categories')}else{updateEl.setStyles({'display':'inline-block'});self.mobileNavFX.toElement('sub-categories');}
if(catID!=0){if(self.xhr!=null&&self.xhr.isRunning())
self.xhr.cancel();self.xhr=new Request.HTML({url:'xhr.php?action=get_mobile_nav',update:updateEl,onRequest:function(){updateEl.empty();updateEl.adopt(self.ajaxSpinner);},onSuccess:function(responseTree,responseElements,responseHTML,responseJavaScript){if(responseHTML==''){updateEl.setProperty('html','<span class="notification error">Unable to retrieve data for this category. Please try again.</span>');}else{updateEl.setProperty('html',responseHTML);var subNav=$('mobile-nav').getElements('ul.level3');if(subNav.length>0){subNav.each(function(item,index){item.dataset.height=item.getCoordinates().height;item.setStyles({'height':0,'opacity':0});});}}}}).get({'category_id':catID});}},toggleMobileSubNav:function(parent,event){event.preventDefault();event.stopPropagation();var subNav=parent.getNext('ul.level3');var toggleIcon=parent.getNext('span.more');if(subNav){if(!parent.dataset.toggled||parent.dataset.toggled==0){var height=subNav.dataset.height.toInt();subNav.setStyles({'height':height,'opacity':1});parent.dataset.toggled=1;if(toggleIcon)toggleIcon.style.backgroundImage="url('assets/svg/minus.svg')";}else{subNav.setStyles({'height':0,'opacity':0});parent.dataset.toggled=0;if(toggleIcon)toggleIcon.style.backgroundImage="url('assets/svg/plus.svg')";}}else{return;}},toggleMedia:function(){},getPalette:function(img,options){var canvas=document.createElement('canvas');var context=canvas.getContext('2d');if(options.debug)
document.body.appendChild(canvas);var scaleMult=img.naturalWidth / img.width;var xPos=(options.x.indexOf('%')>-1)?(img.width*(parseInt(options.x.replace('%',''))/100))*scaleMult:(options.x);var yPos=(options.y.indexOf('%')>-1)?(img.height*(parseInt(options.y.replace('%',''))/100))*scaleMult:(options.y);options.w=((xPos+options.w)>img.naturalWidth)?img.naturalWidth-xPos:options.w;options.h=((yPos+options.h)>img.naturalHeight)?img.naturalHeight-yPos:options.h;canvas.width=options.w;canvas.height=options.h;context.drawImage(img,xPos,yPos,options.w,options.h,0,0,options.w,options.h);var pixels=context.getImageData(0,0,canvas.width,canvas.height);var colors={};for(var i=0;i<pixels.data.length;i+=4){var curColor=pixels.data[i]+'|'+pixels.data[i+1]+'|'+pixels.data[i+2]
colors[curColor]=colors[curColor]?colors[curColor]+1:1;}
var totalK=Object.keys(colors).length;var palette={};var paletteInfo=function(r,g,b,k){return{hex:'#'+((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1),constrast:((0.2126*r)+(0.7152*g)+(0.0722*b)>=165)?'#000':'#fff',total:k};};if(totalK<1)
return null;else if(totalK==1)
return palette[0]=paletteInfo(pixels.data[0],pixels.data[1],pixels.data[2],totalK);var sortedC=[];for(var key in colors)
sortedC.push(key);sortedC.sort(function(a,b){return colors[b]-colors[a]});for(i=0;i<options.palettesize;i++){var rgb=sortedC[i].split('|').map(Number);palette[i]=paletteInfo(rgb[0],rgb[1],rgb[2],colors[sortedC[i]]);}
return palette;},getBasename:function(str){return str.replace(/\\/g,'/').replace(/.*\//,'');},getQueryParam:function(name,url){if(!url)url=this.url.toString();url=url.toLowerCase();name=name.replace(/[\[\]]/g,"\\$&").toLowerCase();var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);if(!results)return null;if(!results[2])return'';return decodeURIComponent(results[2].replace(/\+/g," "));},initCarousels:function(){var elements=$(document.body).getElements('.carousel-this');var self=this;var resizeTimer;self.currentWidth=window.getCoordinates().width;if(elements.length>0){elements.each(function(el,i){self.carousels[i]={'scroller':new Fx.Scroll(el,{onComplete:function(){}}),'data':el.dataset,'slides':el.getElements('li'),'index':0,'timer':((el.dataset.autoRotate==1)?1:null)};if(self.carousels[i].slides.length>1&&self.carousels[i].data.autoRotate==1)
self.autoRotateCarousel(self.carousels[i]);if(el.dataset.altBreakpoint&&el.dataset.altBreakpoint!=''){var breakPoint=parseInt(el.dataset.altBreakpoint);if(self.currentWidth<=breakPoint){el.getElements('li').each(function(slide,i){if(self.currentWidth<=breakPoint&&!el.dataset.altActive){slide.getElement('img').setProperty('src',slide.dataset.alt);}else{slide.getElement('img').setProperty('src',slide.dataset.default);}});}
window.addEvents({'resize':function(){el.dataset.altCheck=true;clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){if(el.dataset.altCheck=true){el.getElements('li').each(function(slide,i){if(self.currentWidth<=breakPoint&&!el.dataset.altActive){slide.getElement('img').setProperty('src',slide.dataset.alt);}else{slide.getElement('img').setProperty('src',slide.dataset.default);}
el.dataset.altCheck=false;});}},500);}});}
if(el.dataset.pagination!=''&&$(el.dataset.pagination)){var pagination=$(el.dataset.pagination).getElements('li');var images=el.getElements('li').getElement('img');if(pagination.length>0){pagination.each(function(pel,pi){pel.addEvents({'click':function(event){clearTimeout(self.carousels[i].timer);pagination.removeClass('active');pel.addClass('active');self.carousels[i].index=pi;self.carousels[i].scroller.toElement(self.carousels[i].slides[pi]);}});});pagination[0].addClass('active');}}});}},autoRotateCarousel:function(carousel){var self=this;clearTimeout(carousel.timer);if($(carousel.data.pagination)){var pagination=$(carousel.data.pagination).getElements('li');pagination.removeClass('active');pagination[carousel.index].addClass('active');}
carousel.index++;if(carousel.index>carousel.slides.length-1)
carousel.index=0;if(carousel.index==0){carousel.scroller.addEvents({'complete':function(){carousel.timer=setTimeout(function(){new Fx.Tween(carousel.scroller.element,{property:'opacity',onComplete:function(){this.set(carousel.slides[carousel.index].getPosition().x,0);this.element.fade('in');this.removeEvents();self.autoRotateCarousel(carousel);}.bind(carousel.scroller)}).start(0);},self.carouselSpeed);}});}else{carousel.timer=setTimeout(function(){carousel.scroller.toElement(carousel.slides[carousel.index]);self.autoRotateCarousel(carousel);},self.carouselSpeed);}},initParallax:function(){var self=this;var elements=$(document.body).getElements('.parallax-this');var contentHeight=$('content').getComputedSize({mode:'vertical'});if(elements.length>0){elements.each(function(el,i){window.addEvent('scroll',function(){var elTop=el.getCoordinates().top-self.options.DOM.header.getCoordinates().height;var relativeScroll=(self.currentScroll-elTop)/contentHeight.height;var friction=175
relativeScroll=relativeScroll*friction;if(el.dataset.parallax!=''){switch(el.dataset.parallax){case'background':el.setStyles({'background-position':'50% '+(50+relativeScroll)+'%'});break;case'element':break;}}});});}},initFancySelects:function(){var self=this;var selects=$$('.custom-ui-select').getElement('select');if(selects.length>0){selects.each(function(item,index){item.fancySelect({showText:true,showImages:false,autoHide:true,autoScrollWindow:true,className:'fancy-select '+((item.getProperty('name'))?'name-'+item.getProperty('name'):''),relativeTo:item.getParent(),legacyEvents:true});});}},initChkBox:function(){var checkbox=$$('.custom-ui-checkbox');if(checkbox.length>0){checkbox.each(function(item,index){var parent=item.getParent().getFirst('input[type=checkbox]');item.addEvent('click',function(){parent.checked=(parent.checked)?false:true;});});}},closeMsg:function(){var self=this;if(document.body.hasClass('notify'))
document.body.removeClass('notify');if(self.xhr!=null&&self.xhr.isRunning())
self.xhr.cancel();self.xhr=new Request.HTML({url:'xhr.php',onSuccess:function(responseTree,responseElements,responseHTML,responseJavaScript){}}).get({'action':'set_notify'});},languageSelect:function(lang){switch(lang){case'en-us':location.href='//www.conair.com';break;case'es-mx':location.href='//es.conair.com';break;}},togglePromoNav:function(parent,event){event.preventDefault();var menu=$('collection-mobile-nav').getFirst('ul');(parent.hasClass('active'))?parent.removeClass('active'):parent.addClass('active');(parent.hasClass('active'))?menu.addClass('active'):menu.removeClass('active');},togglePin:function(parent,event){if(event)
event.preventDefault();var target=$(parent.rel);if(target){if(target.hasClass('active')){target.removeClass('active')
ga('send','event','Pintactic Notification','Toggle','No');}else{target.addClass('active');ga('send','event','Pintactic Notification','Toggle','Yes');}}else return;},facebookShare:function(event){event.preventDefault?event.preventDefault():(event.returnValue=false);FB.ui({href:window.location.href,method:'share'},function(response){});},autoCompleteSearch:function(caller,e){if(e)e.preventDefault();if(!caller)return;switch(e.keyCode){case 38:this.autoCompleteSelect(-1);return;break;case 40:this.autoCompleteSelect(1);return;break;}
var query=caller.value;var resultsContainer=$('serp-autocomplete');document.body.addClass('search-active');resultsContainer.addEvents({"focus":function(){resultsContainer.addClass('active');},"mouseenter":function(){resultsContainer.addClass('active');},"mouseleave":function(){console.log('LEAVE');resultsContainer.removeClass('active');document.body.removeClass('search-active');this.autoCompleteCurrentResult=-1;}});caller.addEvents({"blur":function(){setTimeout(function(){resultsContainer.removeClass('active');document.body.removeClass('search-active');this.autoCompleteCurrentResult=-1;},150);}});if(query){this.autoCompleteResults(query);}else{this.autoCompleteParse(null);}},autoCompleteResults:function(query){var self=this;var data={"engine_key":"QwNbwQ5mf7fCV4gKVSNx","q":query}
var endPoint='https://search-api.swiftype.com/api/v1/public/engines/suggest.json';if(self.xhr&&self.xhr.isRunning())
self.xhr.cancel();self.xhr=new Request.JSON({method:'post',link:'cancel',url:endPoint,data:data,onSuccess:function(json,txt){self.autoCompleteParse(json);}}).send();},autoCompleteParse:function(data){var resultsContainer=$('serp-autocomplete');var maxResults=10;if(!resultsContainer)return;resultsContainer.empty();if(!data)return;var records=data.records.page;if(records.length){resultsContainer.addClass('active');records.forEach(function(e,i,a){var item=new Element('li',{html:(e.st_model)?'('+e.st_model+') '+e.title:e.title,events:{click:function(e){if(e)e.preventDefault();if(e.target){var value=e.target.getProperty('html');var searchForm=$$('#search form[name=global_search]')[0];var queryInput=$('search-query');if(searchForm){queryInput.setProperty('value',value);searchForm.submit();}}}}});item.tabIndex=i+1;if((i+1)<=maxResults)
resultsContainer.adopt(item);});}else{return;}},autoCompleteSelect:function(d){var rc=$('serp-autocomplete');var sq=$('search-query');var r=rc.getElements('li');r.removeClass('active');if(typeof this.autoCompleteCurrentResult=='undefined')
this.autoCompleteCurrentResult=-1;if(r.length){this.autoCompleteCurrentResult=this.autoCompleteCurrentResult+d;if(this.autoCompleteCurrentResult<=0)
this.autoCompleteCurrentResult=0;if(this.autoCompleteCurrentResult>=r.length-1)
this.autoCompleteCurrentResult=r.length-1;for(var i=0;i<=r.length-1;i++){if(r[i].tabIndex==(this.autoCompleteCurrentResult+1)){r[i].addClass('active');sq.value=r[i].textContent;break;}}}},toggleInterstitial:function(target,delay){var target=$(target);var self=this;if(!target)return;if(delay>0){window.setTimeout(function(){self.toggleModal(target,new Event("click"),1);},delay);}else{self.toggleModal(target,new Event("click"),1);}},setStorage:function(k,v){sessionStorage.setItem(k,v);},getStorage:function(k){var v=sessionStorage.getItem(k);if(v)return v;},setLocalStorage:function(k,v){localStorage.setItem(k,v);},getLocalStorage:function(k){var v=localStorage.getItem(k);if(v)return v;},closeBanner:function(p,e){if(e)e.preventDefault();var self=this;var t=$(p.dataset.target);if(!t)return;new Fx.Tween(t,{link:'cancel',property:'opacity',transition:Fx.Transitions.Quint.easeOut,duration:500,onComplete:function(){console.log('here');self.setStorage(p.dataset.target,"-1");t.destroy();}}).start(0);},initPromoBanner:function(el){var self=this;var updateIcon=function(open){var p=el.getParent('#site-promos-container');p.removeClass('active');(open)?p.removeClass('active'):p.addClass('active')};if(typeof self.promoBannerFx==='undefined'){self.promoBannerFx=new Fx.Slide(el,{mode:'vertical',link:'cancel',hideOverflow:true,duration:750,transition:Fx.Transitions.Quint.easeInOut,onStart:function(){updateIcon(this.open);},onComplete:function(){updateIcon(this.open);},onCancel:function(){updateIcon(this.open);}}).hide();}},togglePromoBanner:function(e){if(e)e.preventDefault();var self=this;if(self.promoBannerFx)
self.promoBannerFx.toggle();},chkBannerStatus:function(t){var e=$(t);if(!e)return;var s=this.getStorage(t);if(s=="-1")
e.destroy();},getRetailers:function(parent){var self=this;var target=$('modal-channel-advisor').getElement('.modal-content');target.empty();self.xhr=new Request.JSON({url:'https://plrss-data.where-to-buy.co/feeds/plrss/v1/'+parent.dataset.models,method:'get',data:{'type':'JSON','authorizationToken':self.channelAdvisorTkn,'tag':'Conair_WTB_Button','track':!isCustomUA},onRequest:function(){target.empty();target.adopt(self.ajaxSpinner);},onSuccess:function(json,text){target.empty();var retailers=[];var inStock=[];json.products.forEach(function(p,i){p.retailers.forEach(function(r,i){r.product_meta=p;var cr=retailers.filter(function(n){return n.name===r.name;});if(!cr.length)
retailers.push(r);if(r.instock==='true')
inStock.push(r);});});retailers.forEach(function(r,i){var found=inStock.find(function(element){return element.name===r.name;});if(found)
retailers.splice(i,1,found);});if(retailers.length){retailers.sort(function(a,b){if(a.instock==='true')return-1;if(a.instock!=='true')return 1;return 0;});var ul=new Element('ul',{'class':'retailers'}).inject(target,'top');retailers.forEach(function(r,i){var li=new Element('li',{'class':'retailer'});if(r.instock!=='true')
li.addClass('out-of-stock');var a=new Element('a',{events:{click:function(){ga('send','event','Channel Advisor WTB Vendor',r.product_meta.model_name,r.name.toLowerCase());}},title:'Buy the '+r.product_meta.description+' at '+r.name,href:(r.instock==='true'&&r.deeplink_url!='')?r.deeplink_url:null,target:'_blank'});var span1=new Element('span',{'class':'retailer-status','html':(r.instock==='true')?'Buy Now':'Temporarily Unavailable'});var span2=new Element('span',{'class':'retailer-logo'});var img=new Element('img',{'src':r.logo_url,'alt':r.product_meta.description});li.adopt(a);span2.adopt(img);span2.inject(a,'top');span1.inject(a,'bottom');ul.adopt(li);});}},onFailure:function(){target.empty();target.setProperty('html','Unable to complete request for <strong>'+parent.dataset.model+'</strong>');}}).send();},cartInit:function(){var txId=new Date().getTime();if(!localStorage.getItem('transaction_id'))
localStorage.setItem('transaction_id',txId);if(localStorage.getItem('cart')!=''){this.cart=JSON.parse(localStorage.getItem('cart'));this.cartRender();}},cartToggle:function(caller,e){if(e)e.preventDefault();console.log(e);var target=$(caller.rel);if(!target)return;(target.hasClass('active'))?target.removeClass('active'):target.addClass('active');},cartAdd:function(caller,e,qty){if(e)e.preventDefault();qty=qty||1;qty=parseInt(qty);var data=caller.dataset;if(!data)return;if(!this.cart)this.cart={};var qtyStart=(this.cart[data.model])?parseInt(this.cart[data.model].qty):0;this.cart[data.model]={model:data.model,image:data.image,price:data.price,title:data.title,category:data.category,qty:(this.cart[data.model])?parseInt(this.cart[data.model].qty)+qty:qty};if(caller.value)
this.cart[data.model].qty=parseInt(caller.value);var qtyEnd=parseInt(caller.value);var qtyDiff=(caller.value)?qtyEnd-qtyStart:1;var qtyAction=(qtyDiff>0)?'add':'remove';if(qtyAction=='remove')
qtyDiff=-qtyDiff;var eecData={'id':data.model,'name':data.title,'category':data.category,'price':data.price,'quantity':qtyDiff};ga('ec:addProduct',eecData);if(qtyAction=='add'){console.log(eecData,'ec:setAction','add');ga('ec:setAction','add');ga('send','event',data.model,'click','Add to Cart');}else{console.log(eecData,'ec:setAction','remove');ga('ec:setAction','remove');ga('send','event',data.model,'click','Remove from Cart');}
localStorage.setItem('cart',JSON.stringify(this.cart));this.cartRender(e);var modal=$('modal-cart-confirmation');if(modal&&e.target.className!='cart-qty-input'){this.toggleModal(modal,null,1);this.cartRenderConfirmation(modal.getElement('div.modal-content'));}},cartRemove:function(e,model){if(e)e.preventDefault();var self=this;if(!model)return;try{var itemData=this.cart[model];if(itemData){var eecData={'id':itemData.model,'name':itemData.title,'category':itemData.category,'price':itemData.price,'quantity':itemData.qty};ga('ec:addProduct',eecData);console.log(eecData,'ec:setAction','remove');ga('ec:setAction','remove');ga('send','event',itemData.model,'click','Remove from Cart');}
delete this.cart[model];}catch(err){console.log('Couldn\'t delete model '+model);}
localStorage.setItem('cart',JSON.stringify(this.cart));this.cartRender(e);},cartCreateCheckoutBtn:function(){var self=this;var data=self.cart;var cartData={'items':[]};var cartTotal=0;var txId=(localStorage.getItem('transaction_id'))?localStorage.getItem('transaction_id'):null;var checkOutBtn=new Element('a',{id:'cart-checkout','class':'button',styles:{display:'inline-block'},html:'Checkout',role:'button','aria-label':'Begin checkout',tabIndex:0});if(data&&Object.keys(data).length){var cartUrl=(self.ecommDevMode)?self.ecommLinkDev:self.ecommLinkProd;cartUrl+='Sites-us-conair-Site/default/Shopify-BuildCart?tx='+txId+'&cart=';checkOutBtn.addEvents({'click':function(e){if(e)e.preventDefault();Object.keys(data).forEach(function(e){var p=data[e];if(p){cartData.items.push({'productId':p.model,'qty':p.qty});var price=(p.qty*p.price);cartTotal=cartTotal+parseFloat(price);var productData={'id':p.model,'name':p.title,'category':p.category,'price':p.price,'quantity':p.qty};ga('ec:addProduct',productData);console.log('ec:addProduct',productData);}});var actions={'id':txId,'step':1,'option':'Hand Off to SalesForce'};ga('ec:setAction','checkout',actions);console.log('ec:setAction','checkout',actions);ga('send','event',{eventCategory:'Cart',eventAction:'click',eventLabel:'Checkout to SFCC',transport:'beacon',hitCallback:function(){var payload=JSON.stringify(cartData);console.log('SFCC Link: ',cartUrl+encodeURI(payload));window.location=cartUrl+encodeURI(payload);}});}});}
return checkOutBtn;},cartRenderConfirmation:function(target){var self=this;var data=self.cart;if(!target)return;target.empty();if(data&&Object.keys(data).length){Object.keys(data).forEach(function(e){var p=data[e];var productRow=new Element('div',{id:p.model,'class':'cart-product-row'});var image=new Element('div',{'class':'cart-product-image',html:'<img src="assets/images/database/products/thumb/'+p.image+'" alt=""  />'});var meta=new Element('div',{'class':'cart-product-meta'});var title=new Element('span',{'class':'cart-product-title',html:p.title+' ('+p.model+')'});var quantity=new Element('span',{'class':'cart-product-qty',html:'Qty '+p.qty});var price=new Element('span',{'class':'cart-product-price',html:'$'+(p.price)});var remove=new Element('a',{'class':'cart-product-delete',html:'Delete',events:{click:function(e){self.cartRemove(e,p.model);self.cartRenderConfirmation(target);}}});title.inject(meta,'bottom');quantity.inject(meta,'bottom');price.inject(meta,'bottom');remove.inject(meta,'bottom');image.inject(productRow,'bottom');meta.inject(productRow,'bottom');target.adopt(productRow);});}else{var modalTitle=$('modal-cart-confirmation').getElement('h3.modal-title');if(modalTitle)
modalTitle.setProperty('html','Cart Empty');}
var modalButtons=new Element('div',{id:'cart-modal-buttons'});var continueBtn=new Element('a',{id:'cart-continue','class':'button',html:'Keep Shopping',events:{'click':function(){var modal=target.getParent('.modal');if(modal)
var close=modal.getElement('.modal-close');if(close)
close.fireEvent('click');}}});continueBtn.inject(modalButtons,'bottom');if(data&&Object.keys(data).length){var checkoutButton=this.cartCreateCheckoutBtn();checkoutButton.inject(modalButtons,'bottom');}
modalButtons.inject(target,'bottom');},cartRender:function(e){var data=this.cart;var cartContainer=$('cart-contents');var cartCount=$('cart-count');var total=0;var totalItems=0;var self=this;var injectCheckoutBtn=$('modal-cart').getElement('span.checkout');injectCheckoutBtn.empty();var cartCheckout=this.cartCreateCheckoutBtn();cartCheckout.inject(injectCheckoutBtn,'top');if(!cartContainer)return;cartContainer.empty();if(data&&Object.keys(data).length){Object.keys(data).forEach(function(e){var p=data[e];if(p){var price=(p.qty*p.price);totalItems+=p.qty;var li=new Element('li',{});li.dataset.model=p.model;var a=new Element('a',{"class":"cart-action",events:{click:function(event){self.cartRemove(event,p.model);},keyup:function(event){if(event.key.toLowerCase()==='space'){this.click();}}},tabIndex:0});var spanImage=new Element('span',{"class":"cart-image"});var img=new Element('img',{src:'assets/images/database/products/thumb/'+p.image,events:{error:function(){this.destroy();}}});if(img)spanImage.adopt(img);var spanMeta=new Element('span',{"class":"cart-meta"});var spanModel=new Element('span',{"class":"cart-model",html:p.model});var spanQty=new Element('span',{"class":"cart-qty"});var em1=new Element('i',{html:'QTY'});var input=new Element('input',{'class':'cart-qty-input',type:'number',value:p.qty,tabIndex:0,events:{change:function(evt){self.cartAdd(evt.target,evt);}}});input.dataset.model=p.model;input.dataset.image=p.image;input.dataset.price=p.price;input.dataset.title=p.title;input.dataset.category=p.category;var em3=new Element('i',{html:'$'+(price.toFixed(2))});spanQty.adopt(em1);spanQty.adopt(input);spanQty.adopt(em3);spanMeta.adopt(spanModel);spanMeta.adopt(spanQty);li.adopt(a);li.adopt(spanImage);li.adopt(spanMeta);total=total+parseFloat(price);li.inject(cartContainer,'top');}else{console.log('Unable to get product data');}});var totalRow=new Element('li',{"class":'cart-total',html:'<span>Subtotal</span>$'+total.toFixed(2)});totalRow.inject(cartContainer,'bottom');cartCheckout.setStyles({display:'inline-block'});}else{cartContainer.adopt(new Element('li',{'class':"cart-empty",html:"Cart Empty"}));cartCheckout.setStyles({display:'none'});}
cartCount.setProperty('html',totalItems);},playVideo:function(caller,event){if(event)event.preventDefault();var c=caller;var h=c.getCoordinates().height;var p=c.getParent();p.setStyles({height:h});var v=new Element('video',{'controls':true,'autoplay':true,'poster':c.dataset.poster});var s=new Element('source',{'src':c.href,'type':c.dataset.type});v.adopt(s);c.destroy();p.adopt(v);},bytesToSize:function(bytes){var sizes=['Bytes','KB','MB','GB','TB'];if(bytes==0)return'n/a';var i=parseInt(Math.floor(Math.log(bytes)/ Math.log(1024)));if(i==0)return bytes+' '+sizes[i];return(bytes / Math.pow(1024,i)).toFixed(1)+' '+sizes[i];}});let A11y=function(){let trap;let trapActive=false;let trapTarget;this.initTrap=function(e){if(typeof focusTrap!='object'){console.log('focusTrap lib missing, unable to init');return;}
if(e.code.toLowerCase()==='space'){if(!e.target)
return;this.trapActive=!this.trapActive;e.target.click();e.target.setAttribute("aria-expanded",this.trapActive);this.trapTarget=e.target.getAttribute('aria-controls');this.trapTarget=document.querySelector('#'+this.trapTarget);let cancelEvent=function(e2){if(e2.code.toLowerCase()==='escape'){e.target.click();}}
if(this.trapActive){this.trap=focusTrap.createFocusTrap(this.trapTarget,{onActivate:function(){console.log('trap is active');},onDeactivate:function(){console.log('trap is inactive');}});window.addEventListener('keyup',cancelEvent,{capture:true});this.startTrap();}else{window.removeEventListener('keyup',cancelEvent);this.endTrap();}}},this.startTrap=function(){this.trap.activate();},this.endTrap=function(){this.trap.deactivate();}};var Page=new Class({Extends:Application,Implements:[Options,Events],taxonomy:{},sliderFX:null,accessories:null,booklets:null,categories:null,pageTitle:document.title,paginationItems:null,paginationCount:6,paginationPage:1,raScroll:null,raPageItems:0,raCurrentIndex:0,raMaxPage:0,smgItems:[],smgCurrentIndex:0,initialize:function(options){this.parent(Object.merge(conair.options,options));$$('.image-rwd').forEach(function(img){img.onload=function(){img.setStyles({'max-width':img.naturalWidth+'px','width':'100%','height':'auto'});};});},saveCategories:function(){this.categories=$('categories');},showCategories:function(parent){if(typeof parent.dataset.title!='undefined')
document.title=parent.dataset.title;$('content-wrapper').set('html','');$('content-wrapper').adopt(this.categories);},showIBResults:function(){this.showResults('booklets');},showAccessoriesResults:function(){this.showResults('accessories');},showResults:function(pagetype){var ctx=this,catID=parseInt($('category-select').value),catName=$('category-select').getSelected().get('html'),modelNum=$('searchcat').value,results=[],pageObj;this.drawHeader(pagetype,catName,modelNum);if(pagetype=='accessories'){pageObj=this.accessories;document.title='Parts and Accessories for model '+modelNum.toUpperCase();ga('send','event','Accessories Page','Model',modelNum.toUpperCase());}else{pageObj=this.booklets;document.title='Instruction Booklets for model '+modelNum.toUpperCase();ga('send','event','Instruction Booklets Page','Model',modelNum.toUpperCase());}
if(catID>0&&!modelNum.length){this.showCategory(pagetype,catID,null,catName.toString());return;}
Object.keys(pageObj).forEach(function(key,index){var sPath=pageObj[key].cat_path.split('_');if(((!catID&&modelNum)&&(pageObj[key].model.toUpperCase()==modelNum.toUpperCase()))||((catID&&modelNum)&&(pageObj[key].model.toUpperCase()==modelNum.toUpperCase()&&parseInt(sPath[0])==catID)))
ctx.buildResults(pagetype,pageObj[key],results);});if(results.length<=0){var aElement=new Element('a',{'class':'button','html':'Clear Results',events:{'click':function(){$('searchcat').value=null;this.showCategories(aElement);}.bind(this)}});aElement.dataset.title=this.pageTitle;var h2Element=new Element('h2',{'id':'no-results','html':'No results found for "'+modelNum+'"'});$('content-wrapper').empty();$('content-wrapper').adopt(aElement);$('content-wrapper').adopt(h2Element);}else{$('content-wrapper').adopt(this.drawResult(pagetype,results));}},buildResults:function(pagetype,pageobj,results){var pos=(results.length)?(results.length+1):0;if(pagetype=='accessories'){results[pos]=pageobj;}else{results[pos]=pageobj;}
return results;},drawHeader:function(pagetype,catname,model){$('content-wrapper').set('html','');if(pagetype=='accessories'){var h3Element=new Element('h3',{'id':'search-result','html':(model)?'Model '+model+' Parts &amp; Accessories':'Accessories in '+catname});var h1Element=new Element('h1',{'id':'search-break'});var aElement=new Element('a',{'class':'button','html':'Clear Results',events:{'click':function(){$('searchcat').value=null;this.showCategories(aElement);}.bind(this)}});aElement.dataset.title=this.pageTitle;$('content-wrapper').adopt(h3Element);$('content-wrapper').adopt(h1Element);$('content-wrapper').adopt(aElement);}else{var aElement=new Element('a',{'class':'button','html':'Clear Results',events:{'click':function(){$('searchcat').value=null;this.showCategories(aElement);}.bind(this)}});aElement.dataset.title=this.pageTitle;$('content-wrapper').adopt(aElement);var ulElement=new Element('ul',{'id':'booklet-header'});var liElement=new Element('li',{});var pElement=new Element('p',{'html':'PRODUCT'});liElement.adopt(pElement);ulElement.adopt(liElement);var liElement=new Element('li',{});var pElement=new Element('p',{'html':'MODEL #'});liElement.adopt(pElement);ulElement.adopt(liElement);var liElement=new Element('li',{});var pElement=new Element('p',{'html':'MODEL NAME'});liElement.adopt(pElement);ulElement.adopt(liElement);var liElement=new Element('li',{});var pElement=new Element('p',{'html':'DOWNLOAD'});liElement.adopt(pElement);ulElement.adopt(liElement);$('content-wrapper').adopt(ulElement);}},drawResult:function(pagetype,results){var sectionElement=new Element('section',{'id':'search-results-'+pagetype});if(pagetype=='accessories'){var ulElement=new Element('ul',{'class':'accessory-results'});results.forEach(function(item,index){var liElement=new Element('li',{'class':'accessory'});liElement.dataset.parentModel=item.model;liElement.dataset.status=item.status;var aElement=new Element('a',{'title':item.title,'href':item.cat_link});var spanImageElement=new Element('span',{'class':'part-image'}).inject(aElement,'top');var spanTitleElement=new Element('span',{'class':'part-title','html':item.title}).inject(aElement,'bottom');liElement.adopt(aElement);ulElement.adopt(liElement);Asset.image('assets/images/database/products/thumb/'+item.main_image,{title:item['title'],border:0,styles:{opacity:0},onLoad:function(){spanImageElement.adopt(this);this.fade(1);},onError:function(){spanImageElement.addClass('no-image');this.destroy();}});});sectionElement.adopt(ulElement);}else{results.forEach(function(item,index){var ulElement=new Element('ul',{'class':'booklet-ul'});for(i=1;i<=4;i++){(function(col){var liElement=new Element('li',{'class':'booklet-li'});ulElement.adopt(liElement);switch(col){case 1:Asset.image('assets/images/database/products/thumb/'+item.main_image,{title:item['title'],'class':'product-image',border:0,styles:{opacity:0},onLoad:function(){liElement.adopt(this);if(parseInt(item.status)==1){this.fade(1);}else{this.fade(0.45);}},onError:function(){liElement.addClass('no-image');this.destroy();}});break;case 2:if(parseInt(item.status)){var aElement=new Element('a',{'html':item.model,'href':item.link,'class':'product-link'});liElement.adopt(aElement);}else{var pElement=new Element('p',{'html':item.model});liElement.adopt(pElement);}
break;case 3:var pElement=new Element('p',{'html':item.title});liElement.adopt(pElement);break;case 4:var aElement=new Element('a',{'class':'booklet-link','target':'_blank','href':'assets/files/'+item.filename});var imgElement=new Element('img',{'class':'booklet-img','src':'assets/images/public/content/ib-download.png','border':'0'});aElement.adopt(imgElement);liElement.adopt(aElement);break;}})(i);}
sectionElement.adopt(ulElement);});}
return sectionElement;},showCategory:function(pagetype,catid,prop,catName){var ctx=this,pageObj=null,catname='',results=[];catname=(catName)?catName:prop.getProperty('title');this.drawHeader(pagetype,catname);var sectionElement=new Element('section',{'id':'search-results'});if(pagetype=='accessories'){pageObj=this.accessories;document.title='Parts and Accessories for '+catname+' products';}else{pageObj=this.booklets;document.title='Instruction Booklets for '+catname+' products';}
Object.keys(pageObj).forEach(function(key,index){var cPath=pageObj[key].cat_path;cPath.split('_').forEach(function(path){if(parseInt(path)==catid)
ctx.buildResults(pagetype,pageObj[key],results)});});if(pagetype=='accessories'&&results.length>0){var unique={};var distinct=[];results.forEach(function(x){if(!unique[x.accessory_id]){distinct.push(x);unique[x.accessory_id]=true;}});results=distinct;}
if(results.length<=0){var aElement=new Element('a',{'class':'button','html':'Clear Results',events:{'click':function(){$('searchcat').value=null;this.showCategories(aElement);}.bind(this)}});aElement.dataset.title=this.pageTitle;var h2Element=new Element('h2',{'id':'no-results','html':'No results found for "'+catname+'"'});$('content-wrapper').empty();$('content-wrapper').adopt(aElement);$('content-wrapper').adopt(h2Element);}else{$('content-wrapper').adopt(this.drawResult(pagetype,results));}},showProduct:function(id,type){$('searchcat').value=id;var callBack=function(res){page.showResults(type);}.bind(this);this.xhrRequest(type,callBack);},xhrRequest:function(pagetype,funcCB){var initObj=this,url='';var xhr=('ActiveXObject'in window)?new ActiveXObject('Msxml2.XMLHTTP'):new XMLHttpRequest();xhr.withCredentials=true;if(pagetype=='accessories')
url='xhr.php?action=get_all_accessories';else
url='xhr.php?action=get_all_ibs';var callBack=function(res){if(res.target.response)
if(pagetype=='accessories')
initObj.accessories=JSON.decode(res.target.response);else
initObj.booklets=JSON.decode(res.target.response);if($('content-loading'))
$('content-loading').setStyle('display','none');if(funcCB)
funcCB();}.bind(this);xhr.open('GET',url,true);xhr.onload=callBack;xhr.onerror=callBack;xhr.send();},slide:function(parent,event,state){if(event!=null){event.preventDefault();event.stopPropagation();}
var self=this;var direction=parent.dataset.dir;var initState=parent.dataset.initState;var element=parent.getProperty('rel');direction=(typeof direction!='undefined'&&direction=='vertical')?'vertical':'horizontal';if(self.sliderFX)
if(self.sliderFX.isRunning())self.sliderFX.cancel();if($(element)){self.sliderFX=new Fx.Slide($(element),{mode:direction});}
if(initState=='hide')
self.sliderFX.hide();(state==1)?self.sliderFX.slideIn():self.sliderFX.slideOut();},travelsmartSearch:function(){var country=$('travelsmartSearch').value;var self=this;$('travelsmart-tool-status').setStyle('display','block');ga('send','event','Content','Article','TravelSmart Adapter Search');var el=$('travelsmart-tool-status');el.adopt(conair.ajaxSpinner);el.setStyle('display','block');var jsonRequest=new Request.JSON({url:'xhr.php',method:'get',data:{'action':'get_widget_travelsmartproducts','country':country},onSuccess:function(data){el.empty();el.setStyle('display','none');self.data=data;self.travelsmartShow('adapters',null);}}).send();},travelsmartShow:function(type,event){var self=this;if(event){event.preventDefault();event.stopPropagation();}
var links=$$('.adapter-results-links a').removeClass('active');var el=(type=='adapters')?$('adapter-links-adapters'):$('adapter-links-converters');var imageIndex=0;var imagesTotal=Object.keys(this.data[type]).length;el.addClass('active');var travelImgCount=function(){imageIndex++;if(imagesTotal!=imageIndex)
return;var el=$('travel-tool-results');el.setStyle('max-height',el.scrollHeight+'px');};var ulElement=new Element('ul');var liElements=Object.keys(this.data[type]).map(function(item){var product=self.data[type][item];var link=new Element('a',{'href':product.link});var image=new Element('img',{'src':'assets/images/database/products/thumb/'+product.main_image});var image=Asset.image('assets/images/database/products/thumb/'+product.main_image,{alt:product.title,onLoad:travelImgCount,onError:travelImgCount});var text=new Element('span',{'html':product.model});return new Element('li').adopt(link.adopt(image,text));});ulElement.adopt(liElements);$('adapter-results-slider').empty();$('adapter-results-slider').adopt(ulElement);},initHelpSliders:function(sliderSections){var self=this;var isFaqSection=(self.taxonomy.enumPath.substring(0,6)=='101_84')?true:false;sliderSections.each(function(s,i,a){var urlFragment=(self.url.get('fragment'))?self.url.get('fragment'):'customer-faqs';var toggler=s.getElement('h2');var slideFx=new Fx.Slide(s.getElement('.section-detail'),{mode:'vertical',resetHeight:true}).hide();toggler.addEvents({'click':function(e){if(slideFx.open){toggler.removeClass('active');}else{toggler.addClass('active');}
slideFx.toggle();}});if(urlFragment&&urlFragment==s.getProperty('id')){if(self.currentWidth>=550)
toggler.fireEvent('click');}
if(isFaqSection&&s.getProperty('id')=='customer-faqs'){toggler.fireEvent('click');}});},faqHelp:function(caller,event,subjectChoice){if(event)event.preventDefault();var c=$('customer-faqs').getElement('select[name="category_select"]');if(c)c=c.options[c.selectedIndex].text;var t=$('customer-email').getElement('h2');if(t&&!t.hasClass('active'))t.fireEvent('click');var s=$('cc-subject-choice').get('fancySelect');if(s)s.select(subjectChoice);var s2=$('cc-subject');if(s2+c)s2.value='Unable to find question in '+c;},rtnFormToggle:function(p,e){if(e)e.preventDefault();var serial=$('rr-serial-container');var receipt=$('rr-receipt-container');if(!serial||!receipt)return;serial.removeClass('hidden');receipt.removeClass('hidden');if(p.value==1)serial.addClass('hidden');if(p.value==-1)receipt.addClass('hidden');},rtnFormFileRemove:function(p,e){if(e)e.preventDefault();var t=$(p.dataset.target);if(!t)return;var feedBack=$('rr-user-feedback');var upload=$('rr-receipt-upload');var fn=$('rr-receipt-file-fn');if(feedBack)
feedBack.addClass('hidden');upload.value=null;t.value=null;fn.empty();},rtnFormFileUpload:function(p,e){if(e)e.preventDefault();if(!p.files.length)return;var tests={'filereader':typeof FileReader!='undefined','formdata':!!window.FormData};['filereader','formdata'].each(function(k){if(tests[k]===false){alert('Unable to upload image, this device isn\'t compatible');return;}});var f=p.files[0];var fType=f.type;var trash=$$('.trash');var t=$(p.dataset.target);var rp=p.getPrevious('label.custom-upload');var fn=$('rr-receipt-file-fn');var feedBack=$('rr-user-feedback');var fr=new FileReader();var fd=new FormData();console.log('FileInfo:',f);if(f.size>=window.maxUploadSize){alert(`Max upload is ${this.bytesToSize(window.maxUploadSize)}, your file is ${this.bytesToSize(f.size)}`);return;}
fType=fType.split("/");if(fType[0]!='image'){alert(`Your file is of type "${f.type}", you can only upload image files`);return;}
fn.empty();t.value=null;fr.onloadstart=(function(){rp.innerText='Loading...';}).bind(this);fr.onload=(function(e){fd.append('rr_receipt_upload',f);var req=('ActiveXObject'in window)?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest();var trashIcon=new Element('a',{class:'icon trash',events:{click:function(e){this.rtnFormFileRemove(trashIcon,e)}.bind(this)}});trashIcon.dataset.target='rr-receipt-file';req.onreadystatechange=(function(event){if(req.readyState===4&&req.status===200){var data=JSON.decode(req.response);var fpb=new Element('input',{'name':'rr_receipt_file_pb','class':null,'value':f.name});var fs=new Element('span',{'class':'rr-receipt-file-size','html':'('+this.bytesToSize(f.size)+')'});if(feedBack)
feedBack.removeClass('hidden');if(t&&data)
t.value=data.filename;if(fn){fn.empty();fpb.inject(fn,'bottom');fs.inject(fn,'bottom');}
trashIcon.inject(fn,'bottom');}}).bind(this);req.onloadend=(function(){rp.innerText='Upload your Receipt';});req.onerror=(function(){console.log("Unable to upload file: "+f.name);rp.innerText='Upload your Receipt';});req.onprogress=(function(e){});req.open('POST','api/upload-file/rr_receipt_upload',true);req.send(fd);}).bind(this);fr.onprogress=(function(e){rp.innerText='Loading...';});fr.onloadstart=(function(e){rp.innerText='Loading...';});fr.onloadend=(function(){});fr.readAsText(f);},getFaqQuestions:function(currentEnumPath,target){var self=this;var url=_WS_ROOT+'api/faq-questions/'+((currentEnumPath)?currentEnumPath:null);if(typeof target==='string'){target=$(target);}
console.log(target);if(!target){console.log('Unable to find target: ',target);return;}
self.xhr=new Request.JSON({url:url,method:'get',data:{format:'json'},onRequest:function(){target.empty();target.adopt(self.ajaxSpinner);},onSuccess:function(json,txt){target.empty();if(json){if(json.categories){var catContentsDesktop=new Element('div',{id:'faq-cat-contents-desktop'});json.categories.each(function(c,i,array){var catContents=new Element('div',{id:('faq-cat-'+c.enumPath),class:'faq-cat-contents-mobile'});var catTitle=new Element('div',{class:'faq-cat-title',html:c.title,events:{click:function(){target.getElements('.faq-cat-title').removeClass('active');target.getElements('.faq-cat-contents-mobile').removeClass('active');this.addClass('active');catContents.addClass('active');self.getFaqQuestions(c.enumPath,((self.currentWidth<=620)?catContents:catContentsDesktop));}}});catTitle.dataset.enumPath=c.enumPath;catTitle.inject(target,'bottom');catContents.inject(target,'bottom');if(i==0)
catTitle.fireEvent('click');});catContentsDesktop.inject(target,'bottom');}
if(json.questions){var ul=new Element('ul',{}).inject(target,'bottom');json.questions.each(function(q,i,array){var answer=new Element('span',{'class':'answer',html:q.answer});var li=new Element('li',{});li.dataset.fullUrl=q.url;li.dataset.guid=q.guid;if(self.taxonomy.guid==q.guid)
li.addClass('selected');answer.inject(li,'bottom');var slideFx=new Fx.Slide(answer,{mode:'vertical',resetHeight:true});if(self.taxonomy.guid!=q.guid)
slideFx.hide();var question=new Element('span',{'class':'question'});var questionLink=new Element('a',{html:q.question,href:_WS_ROOT+q.url,events:{click:function(e){e.preventDefault();history.pushState({id:q.guid,enum_path:q.enumPath,location:_WS_ROOT+q.url,},q.title,q.url);ga('send','event','Customer Care/FAQs','click',q.question);slideFx.toggle();}}});question.adopt(questionLink);question.inject(li,'top');li.inject(ul,'bottom');});}}}}).send();},initCarousel:function(carousel){if(!carousel)return;var self=this;var slides=carousel.getElements('li');var delay=4000;var pagination=$(carousel.dataset.pagination);if(pagination){var paginationEls=pagination.getElements('li');paginationEls.forEach(function(el,i,array){el.addEvents({'click':function(){clearTimeout(self.collectionCarouselTimer);self.collectionCarouselIndex=i;self.collectionCarousel.toElement(slides[i]);paginationEls.removeClass('active');el.addClass('active');}});});}
self.collectionCarouselIndex=0;self.collectionCarousel=new Fx.Scroll(carousel,{wheelStops:false,link:'cancel',onStart:function(){if(self.collectionCarouselIndex==0)
carousel.setStyles({'opacity':0});},onComplete:function(){clearTimeout(self.collectionCarouselTimer);paginationEls.removeClass('active');paginationEls[self.collectionCarouselIndex].addClass('active');carousel.setStyles({'opacity':1});self.collectionCarouselIndex++;if(self.collectionCarouselIndex>=slides.length)
self.collectionCarouselIndex=0
self.collectionCarouselTimer=setTimeout(function(){self.collectionCarousel.toElement(slides[self.collectionCarouselIndex]);},delay);}}).toElement(slides[self.collectionCarouselIndex]);},changeCountry:function(){var countrySelect=$('country-select');if(countrySelect){if(countrySelect.value!=''){this.url.setData({'country':countrySelect.value},true);window.location=this.url.toString();}else return;}},facebookShare:function(event){event.preventDefault?event.preventDefault():(event.returnValue=false);FB.ui({href:window.location.href,method:'share'},function(response){});},toggleSendSending:function(id,tString,fString){self=this;if(self.validateFormById(id)){return tString;}
return fString;},validateFormById:function(id){var fields=document.getElementById(id).querySelectorAll("[required]");if(fields){for(var i=0;i<fields.length;i++){if(!fields[i].value||!fields[i].validity.valid)
return false;}}
return true;},initRelated:function(scrollerEl,relatedPageItems){if(!scrollerEl)return;this.raPageItems=relatedPageItems;this.raScroll=new Fx.Scroll(scrollerEl,{wheelStops:false});return this.raScroll;},scrollRelated:function(caller,e){if(e)e.preventDefault();if(!caller)return;var data=caller.dataset;var dir=parseInt(data.dir);var relatedArticles=this.raScroll.element.children;var relatedArticlesTotal=relatedArticles.length;this.raMaxPage=relatedArticlesTotal-this.raPageItems;this.raCurrentIndex+=dir;if(this.raCurrentIndex<=0)this.raCurrentIndex=0;if(this.raCurrentIndex>=this.raMaxPage)this.raCurrentIndex=this.raMaxPage;if(relatedArticles[this.raCurrentIndex])
this.raScroll.toElement(relatedArticles[this.raCurrentIndex]);},getMedia:function(parent,e){if(e)e.preventDefault();var modal=$(parent.dataset.modal),media=parent.dataset.file,spinner=this.ajaxSpinner;if(modal)
var container=modal.getElement('div.modal-content');if(!container||!media)
return;var type=parent.dataset.mimeType;if(type){type=type.slice(0,type.indexOf('/'));container.adopt(spinner);container.addClass('loading');var eventMediaLabel=media.split('/');eventMediaLabel=eventMediaLabel.pop();switch(type){case'image':var item=Asset.image(media,{onLoad:function(){spinner.destroy();if(container.hasClass('loading'))
container.removeClass('loading');container.adopt(this);ga('send','event','VS2018 Fashion Show','Image Open',eventMediaLabel);}});break;case'video':var source=new Element('source',{src:media,type:parent.dataset.mimeType});var video=new Element('video',{controls:true,autoplay:true,poster:(parent.dataset.thumb)?parent.dataset.thumb:null});spinner.destroy();if(container.hasClass('loading'))
container.removeClass('loading');video.adopt(source);container.adopt(video);ga('send','event','VS2018 Fashion Show','Video Play',eventMediaLabel);break;}}else{console.log('Could not detect media type');}},vsGalleryInit:function(items,count){if(items.length<=0)return;this.paginationItems=items;this.paginationCount=count;this.vsGalleryLoadMore();},vsGalleryLoadMore:function(){var itemsToShow=this.paginationPage*this.paginationCount;if(itemsToShow>this.paginationItems.length){$('vs-gallery-load-more').setStyles({'display':'none'});}
this.paginationItems.forEach(function(item,i){item.setStyles({'display':(i>=itemsToShow)?'none':'inline-block'});});this.paginationPage++;},smgGetMedia:function(p,e){if(e)e.preventDefault();var g=$('sm-gallery-grid')
var t=$('sm-modal-container');if(t)t.empty();if(!this.smgItems.length&&g)
this.smgItems=g.getElements('li');var data=p.dataset;this.smgCurrentIndex=parseInt(data.index);var type=data.type.split("/").shift();switch(type){case'image':var m=new Element('img',{src:data.src});break;case'video':var m=new Element('video',{width:"100%",height:"100%",autoplay:true,controls:true});var s=new Element('source',{src:data.src,type:"video/mp4"});m.adopt(s);break;}
t.adopt(m);},smgToggleModal:function(p,s,e){if(e)e.preventDefault();var t=$(p.rel);if(!t)return;if(!s)$('sm-modal-container').empty();(!s)?t.removeClass('active'):t.addClass('active');},smgPaginate:function(d,e){if(e)e.preventDefault();var t=this.smgItems.length;this.smgCurrentIndex+=d;if(this.smgCurrentIndex<0)
this.smgCurrentIndex=0;if(this.smgCurrentIndex>=(t-1))
this.smgCurrentIndex=(t-1);var el=this.smgItems[this.smgCurrentIndex].getElement('a');console.log(el);if(el){this.smgToggleModal(el,true,null);this.smgGetMedia(el,null);}}});var AutoComplete=new Class({autoData:null,dataDisplay:null,queryField:null,searchField:null,onSubmit:null,resultLimit:5,templateText:null,displayText:function(data){var regex=/{([^}]+)}/g;var curMatch;var retText=this.templateText;while(curMatch=regex.exec(this.templateText)){if(txtOption=curMatch[1].split(':')){displayTxt=data[txtOption[0]];txtOption=txtOption[1];switch(txtOption){case'uppercase':displayTxt=displayTxt.toUpperCase();break;case'lowercase':displayTxt=displayTxt.toLowerCase();break;default:break;}}else{displayTxt=data[curMatch[1]];}
retText=retText.replace('{'+curMatch[1]+'}',displayTxt);}
return retText;},update:function(dataDisplay,searchField){this.dataDisplay.removeEvents();this.dataDisplay=dataDisplay;this.searchField.removeEvents();this.searchField=searchField;this.initEvents();},initialize:function(opts){var initObj=this;initObj.templateText=opts.templateText;initObj.dataDisplay=opts.dataDisplay;initObj.searchField=opts.searchField;initObj.queryField=opts.queryField;initObj.onSubmit=opts.onSubmit;initObj.resultLimit=(opts.resultLimit)?opts.resultLimit:5;this.xhrProducts(opts.url,opts.queryField);this.initEvents();},initEvents:function(){var initObj=this;var searchField=this.searchField;searchField.addEvents({'keydown':function(e){},'keyup':function(e){if(initObj.dataDisplay.getStyle('display')=='block'){var liElements=initObj.dataDisplay.getElements('li')[0];var liActive=liElements.hasClass('active');var keyReturn=1;switch(e.key){case'backspace':keyReturn=0;break;case'enter':liActive.forEach(function(index,key){if(index==true)
searchField.value=liElements[key].id;});initObj.dataDisplay.setStyle('display','none');if(initObj.onSubmit)
initObj.execOnSubmit(initObj.onSubmit,window);break;case'up':case'down':var liSet=0;var keyPos=(e.key=='down')?1:-1;liElements.removeClass('active');if(liActive.length>=1){liActive.forEach(function(index,key){if((index==true)&&(key+keyPos!=liActive.length)&&(key+keyPos>=0)){liSet=1;liElements[key+keyPos].addClass('active');}});}
if(!liSet)
liElements[0].addClass('active');break;case'esc':case'tab':initObj.dataDisplay.setStyle('display','none');break;default:keyReturn=0;}
if(keyReturn)
return;}
if(!searchField.value||(e.code==27))
initObj.dataDisplay.setStyle('display','none');else
initObj.dataDisplay.setStyle('display','block');initObj.dataDisplay.set('html','');var regexString="";searchField.value.split(/\s+/g).forEach(function(sString){if(sString.length)
regexString+='(?=.*'+sString+')|';});regexString=regexString.replace(/\|+$/,'');if(searchResults=initObj.searchProducts(regexString,initObj.resultLimit)){searchResults.each(function(result){var liElement=new Element('li',{'id':result[initObj.queryField],});liElement.addEvent('click',function(){searchField.value=result[initObj.queryField];initObj.dataDisplay.setStyle('display','none');if(initObj.onSubmit)
initObj.execOnSubmit(initObj.onSubmit,window);});var trimTitle=initObj.displayText(result);var trimTitle=trimTitle.length>65?trimTitle.substring(0,65-3)+"...":trimTitle.substring(0,65);searchField.value.split(/\s+/g).forEach(function(sString){if(sString.length){var regex=new RegExp('('+sString+')','gi');trimTitle=trimTitle.replace(regex,"<span class='auto-hl'>$1</span>");}});liElement.set('html',trimTitle);initObj.dataDisplay.adopt(liElement);});}else{var liElement=new Element('li',{'id':'',});liElement.set('html','No results');initObj.dataDisplay.adopt(liElement);}},'focus':function(){},'blur':function(e){setTimeout(function(){e.preventDefault();initObj.dataDisplay.setStyle('display','none');},150);},'mousemove':function(){},});},searchProducts:function(searchVal,limit){var matches=[];var initObj=this;var regexp=new RegExp(searchVal,'gi');if(!limit)
limit=5;var catID=$('category-select')?parseInt($('category-select').value):false;for(var i=0,resultsFound=0;i<initObj.autoData.length&&resultsFound<limit;i++){if((initObj.autoData[i].combined.match(regexp))&&((catID!=0&&catID==parseInt(initObj.autoData[i].catid))||(!catID))){matches.push(initObj.autoData[i]);resultsFound++;}}
if(matches.length)
return matches;else
return null;},execOnSubmit:function(functionName,context){var args=[].slice.call(arguments).splice(2);var namespaces=functionName.split(".");var func=namespaces.pop();for(var i=0;i<namespaces.length;i++)
context=context[namespaces[i]];return context[func].apply(context,args);},xhrProducts:function(url,fields){var initObj=this;var xhr=('ActiveXObject'in window)?new ActiveXObject('Msxml2.XMLHTTP'):new XMLHttpRequest();xhr.withCredentials=true;var combFields=fields.split(',');var callBack=function(res){if(res.target.response){initObj.autoData=JSON.decode(res.target.response);for(var i=0;i<initObj.autoData.length;i++){initObj.autoData[i].combined='';for(var c=0;c<combFields.length;c++)
initObj.autoData[i].combined+=initObj.autoData[i][combFields[c]]+' ';}}}.bind(this);xhr.open('GET',url,true);xhr.onload=callBack;xhr.onerror=callBack;xhr.send();}});